"use strict";exports.id=61,exports.ids=[61],exports.modules={1022:(e,n,o)=>{o.d(n,{I:()=>mongooseConnect});var i=o(1185),s=o.n(i);function mongooseConnect(){if(1===s().connection.readyState)return s().connection.asPromise();{let e=process.env.MONGODB_URI;return s().connect(e)}}},8003:(e,n,o)=>{o.d(n,{w:()=>t});var i=o(1185);let s=new i.Schema({email:{type:String,required:!0,unique:!0}},{timestamps:!0}),t=i.models?.Admin||(0,i.model)("Admin",s)},9061:(e,n,o)=>{let i;o.r(n),o.d(n,{authOptions:()=>p,default:()=>v,isAdminRequest:()=>isAdminRequest});var s=o(3227),t=o.n(s),r=o(3598),a=o.n(r),l=o(166),c=o(8013);if(!process.env.MONGODB_URI)throw Error('Invalid/Missing environment variable: "MONGODB_URI"');let d=process.env.MONGODB_URI;i=new c.MongoClient(d,{}).connect();var m=o(8003),u=o(1022);async function isAdminEmail(e){return(0,u.I)(),!!await m.w.findOne({email:e})}let p={providers:[a()({clientId:process.env.GOOGLE_ID,clientSecret:process.env.GOOGLE_SECRET})],adapter:(0,l.MongoDBAdapter)(i),callbacks:{async session({session:e,token:n,user:o}){if(console.log("Session:",e),console.log("Token:",n),console.log("User:",o),!o||!o.email)return console.log("No user or email found in session."),!1;{let n=await isAdminEmail(o.email);return n?e:(console.log("User is not an admin:",o.email),!1)}}}},v=t()(p);async function isAdminRequest(e,n){let o=await (0,s.getServerSession)(e,n,p);if(!await isAdminEmail(o?.user?.email))throw n.status(401),n.end(),"not an admin"}}};