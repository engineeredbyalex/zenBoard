"use strict";(()=>{var e={};e.id=39,e.ids=[39],e.modules={166:e=>{e.exports=require("@next-auth/mongodb-adapter")},8013:e=>{e.exports=require("mongodb")},1185:e=>{e.exports=require("mongoose")},3227:e=>{e.exports=require("next-auth")},3598:e=>{e.exports=require("next-auth/providers/google")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},3903:(e,r,t)=>{t.r(r),t.d(r,{config:()=>h,default:()=>f,routeModule:()=>q});var a={};t.r(a),t.d(a,{config:()=>w,default:()=>handle});var n=t(1802),o=t(7153),i=t(6249);let s=require("multiparty");var l=t.n(s);let u=require("@aws-sdk/client-s3"),p=require("fs");var d=t.n(p);let c=require("mime-types");var m=t.n(c),g=t(1022),x=t(9061);let _="maybee-nextjs-ecommerce";async function handle(e,r){await (0,g.I)(),await (0,x.isAdminRequest)(e,r);let t=new(l()).Form,{fields:a,files:n}=await new Promise((r,a)=>{t.parse(e,(e,t,n)=>{e&&a(e),r({fields:t,files:n})})});console.log("length:",n.file.length);let o=new u.S3Client({region:"eu-north-1",credentials:{accessKeyId:process.env.S3_ACCESS_KEY,secretAccessKey:process.env.S3_SECRET_ACCESS_KEY}}),i=[];for(let e of n.file){let r=e.originalFilename.split(".").pop(),t=Date.now()+"."+r;await o.send(new u.PutObjectCommand({Bucket:_,Key:t,Body:d().readFileSync(e.path),ACL:"public-read",ContentType:m().lookup(e.path)}));let a=`https://${_}.s3.amazonaws.com/${t}`;i.push(a)}return r.json({links:i})}let w={api:{bodyParser:!1}},f=(0,i.l)(a,"default"),h=(0,i.l)(a,"config"),q=new n.PagesAPIRouteModule({definition:{kind:o.x.PAGES_API,page:"/api/upload",pathname:"/api/upload",bundlePath:"",filename:""},userland:a})}};var r=require("../../webpack-api-runtime.js");r.C(e);var __webpack_exec__=e=>r(r.s=e),t=r.X(0,[222,61],()=>__webpack_exec__(3903));module.exports=t})();